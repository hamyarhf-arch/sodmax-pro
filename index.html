<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SODmAX Pro | Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ Ø¨Ø§ Ù¾Ø§Ø¯Ø§Ø´ USDT</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- ØµÙØ­Ù‡ Ø«Ø¨Øª Ù†Ø§Ù… -->
    <div class="register-overlay" id="registerOverlay">
        <div class="register-container">
            <div class="register-header">
                <div class="register-icon">â›ï¸</div>
                <h1 class="register-title">Ø«Ø¨Øª Ù†Ø§Ù… Ø¯Ø± SODmAX</h1>
                <p class="register-subtitle">Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ùˆ Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø¯Ø§Ø´ USDT Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ù†ÛŒØ¯</p>
            </div>

            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label">Ù†Ø§Ù… Ùˆ Ù†Ø§Ù… Ø®Ø§Ù†ÙˆØ§Ø¯Ú¯ÛŒ</label>
                    <input type="text" class="form-input" placeholder="Ù…Ø«Ø§Ù„: Ø¹Ù„ÛŒ Ù…Ø­Ù…Ø¯ÛŒ" id="fullName" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Ø§ÛŒÙ…ÛŒÙ„</label>
                    <input type="email" class="form-input" placeholder="example@gmail.com" id="email" required>
                </div>

                <div class="form-group">
                    <label class="form-label">Ú©Ø¯ Ø¯Ø¹ÙˆØª (Ø§Ø®ØªÛŒØ§Ø±ÛŒ)</label>
                    <input type="text" class="form-input" placeholder="Ú©Ø¯ Ø¯ÙˆØ³Øª Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯" id="referralCode">
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-user-plus"></i>
                    Ø«Ø¨Øª Ù†Ø§Ù… Ùˆ Ø´Ø±ÙˆØ¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬
                </button>

                <div style="text-align: center; margin-top: 20px; color: var(--text-secondary); font-size: 12px;">
                    Ø¨Ø§ Ø«Ø¨Øª Ù†Ø§Ù…ØŒ <a href="#" onclick="showTerms()" style="color: var(--primary-light);">Ù‚ÙˆØ§Ù†ÛŒÙ† Ùˆ Ø´Ø±Ø§ÛŒØ·</a> Ø±Ø§ Ù…ÛŒâ€ŒÙ¾Ø°ÛŒØ±ÛŒØ¯
                </div>
            </form>
        </div>
    </div>

    <!-- Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ -->
    <div class="container" id="mainContainer" style="display: none;">
        <!-- Ù†Ø§ÙˆØ¨Ø±ÛŒ -->
        <nav class="navbar">
            <div class="nav-background"></div>
            
            <a href="#" class="logo">
                <div class="logo-icon">â›ï¸</div>
                <div class="logo-text">
                    <div class="logo-title">SODmAX Pro</div>
                    <div class="logo-subtitle">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù‡ÙˆØ´Ù…Ù†Ø¯ â€¢ Ù¾Ø§Ø¯Ø§Ø´ ÙˆØ§Ù‚Ø¹ÛŒ</div>
                </div>
            </a>

            <!-- Ù…Ù†ÙˆÛŒ navigation -->
            <div class="nav-menu">
                <a href="dashboard.html">
                    <i class="fas fa-chart-line"></i>
                    <span class="nav-text">Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯</span>
                </a>
                <a href="leaderboard.html">
                    <i class="fas fa-trophy"></i>
                    <span class="nav-text">Ù„ÛŒØ¯Ø±Ø¨Ø±Ø¯</span>
                </a>
                <a href="missions.html">
                    <i class="fas fa-tasks"></i>
                    <span class="nav-text">Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§</span>
                </a>
                <!-- Ù„ÛŒÙ†Ú© Ù…Ø¯ÛŒØ±ÛŒØª - ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ø§Ø¯Ù…ÛŒÙ† Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
                <a href="admin.html" id="adminLink" style="display: none; background: rgba(148,163,184,0.3);">
                    <i class="fas fa-user-shield"></i>
                    <span class="nav-text">Ù…Ø¯ÛŒØ±ÛŒØª</span>
                </a>
            </div>

            <div class="wallet-section">
                <div class="wallet-row">
                    <div class="wallet-card">
                        <div class="wallet-label">
                            <i class="fas fa-coins"></i>
                            Ù…ÙˆØ¬ÙˆØ¯ÛŒ SOD
                        </div>
                        <div class="wallet-amount" id="sodBalance">Û° <span>SOD</span></div>
                    </div>
                    
                    <div class="wallet-card">
                        <div class="wallet-label">
                            <i class="fas fa-gem"></i>
                            Ù…ÙˆØ¬ÙˆØ¯ÛŒ USDT
                        </div>
                        <div class="wallet-amount" id="usdtBalance">Û° <span>USDT</span></div>
                    </div>
                </div>
                
                <button class="btn btn-primary" onclick="showSODSale()">
                    <i class="fas fa-shopping-cart"></i>
                    Ø®Ø±ÛŒØ¯ SOD
                </button>
            </div>
        </nav>

        <!-- Ø¨Ø®Ø´ Ù…Ø§ÛŒÙ†Ø± -->
        <section class="miner-section">
            <div class="section-header">
                <h1 class="section-title">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ù‡ÙˆØ´Ù…Ù†Ø¯ SOD</h1>
                <p class="section-subtitle">
                    Ø¨Ø§ Ù¾ÛŒØ´Ø±ÙØªÙ‡â€ŒØªØ±ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø§Ø³ØªØ®Ø±Ø§Ø¬ ÙˆØ¨Û³ØŒ Ù‡Ø± Ú©Ù„ÛŒÚ© Ø´Ù…Ø§ <span class="highlight">SOD</span> ØªÙˆÙ„ÛŒØ¯ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
                    Ù‡Ø± <span class="highlight">Û±Û° Ù…ÛŒÙ„ÛŒÙˆÙ† SOD</span> Ù…Ø¹Ø§Ø¯Ù„ <span class="highlight">Û°.Û°Û± USDT (Û± Ø³ÙÙ†Øª)</span> Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯.
                </p>
            </div>

            <div class="miner-container">
                <!-- Ù…Ø§ÛŒÙ†Ø± ÙˆÛŒÙˆ -->
                <div class="miner-view">
                    <div class="miner-display">
                        <div class="miner-core" id="minerCore">
                            <div class="core-inner">
                                <div class="core-content">
                                    <div class="core-icon">âš¡</div>
                                    <div class="click-reward" id="clickReward">+Û±Û°Û° SOD</div>
                                    <div class="click-label">Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="miner-controls">
                        <button class="btn btn-primary" id="autoMineBtn">
                            <i class="fas fa-robot"></i>
                            Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø±
                        </button>
                        <button class="btn btn-outline" onclick="showSODSale()">
                            <i class="fas fa-shopping-cart"></i>
                            Ø®Ø±ÛŒØ¯ SOD
                        </button>
                        <button class="btn btn-success" onclick="boostMining()">
                            <i class="fas fa-bolt"></i>
                            Ø§ÙØ²Ø§ÛŒØ´ Ù‚Ø¯Ø±Øª
                        </button>
                    </div>
                </div>

                <!-- Ø§Ø³ØªØ§Øª ÙˆÛŒÙˆ -->
                <div class="stats-view">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-title">Ø¯Ø±Ø¢Ù…Ø¯ Ø§Ù…Ø±ÙˆØ²</div>
                                <div class="stat-value" id="todayEarnings">Û° SOD</div>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-title">Ù‚Ø¯Ø±Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬</div>
                                <div class="stat-value" id="miningPower">Û±Û°x</div>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-title">Ù…Ø§ÛŒÙ†Ø±Ù‡Ø§ÛŒ ÙØ¹Ø§Ù„</div>
                                <div class="stat-value">Û¸,Û´Û²Û±</div>
                            </div>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon">
                                <i class="fas fa-network-wired"></i>
                            </div>
                            <div class="stat-info">
                                <div class="stat-title">Ú©Ù„ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø´Ø¨Ú©Ù‡</div>
                                <div class="stat-value">Û²Û´.ÛµM SOD</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Ø¨Ø®Ø´ Ù¾Ù†Ù„â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ ÙØ±ÙˆØ´ SOD -->
        <section class="sod-sale-section" id="sodSaleSection" style="display: none;">
            <div class="section-header">
                <h2 class="section-title">ğŸ›’ Ù¾Ù†Ù„â€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ù‡ ÙØ±ÙˆØ´ SOD</h2>
                <p class="section-subtitle">
                    SOD Ø¨ÛŒØ´ØªØ±ÛŒ Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ú©Ù†ÛŒØ¯ Ùˆ Ø³Ø±Ø¹Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯ Ø±Ø§ Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ù‡ÛŒØ¯. Ù‡Ø± Ù¾Ù†Ù„ Ø´Ø§Ù…Ù„ Ù…Ø²Ø§ÛŒØ§ÛŒ ÙˆÛŒÚ˜Ù‡â€ŒØ§ÛŒ Ø§Ø³Øª.
                </p>
            </div>

            <div class="sale-plans-grid" id="salePlansGrid">
                <!-- Ù¾Ù†Ù„â€ŒÙ‡Ø§ Ø¨Ø§ JS Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
            </div>
        </section>

        <!-- Ø¨Ø®Ø´ Ù¾Ø§Ø¯Ø§Ø´ USDT -->
        <section class="reward-section">
            <div class="reward-header">
                <div>
                    <h2 class="reward-title">ğŸ Ù¾Ø§Ø¯Ø§Ø´ USDT ÙˆØ§Ù‚Ø¹ÛŒ</h2>
                    <p class="reward-subtitle">Ù‡Ø± Û±Û° Ù…ÛŒÙ„ÛŒÙˆÙ† SOD Ù…Ø¹Ø§Ø¯Ù„ <span class="highlight">Û°.Û°Û± USDT (Û± Ø³ÙÙ†Øª)</span> Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>
                </div>
                <button class="btn btn-success" id="claimUSDTBtn">
                    <i class="fas fa-gift"></i>
                    Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø¯Ø§Ø´
                </button>
            </div>

            <div class="reward-card">
                <div class="reward-info">
                    <h3><i class="fas fa-wallet"></i> Ù…ÙˆØ¬ÙˆØ¯ÛŒ USDT Ø´Ù…Ø§</h3>
                    <div class="reward-amount" id="availableUSDT">Û° USDT</div>
                </div>
                <div class="reward-info">
                    <h3><i class="fas fa-bullseye"></i> ØªØ§ Ù¾Ø§Ø¯Ø§Ø´ Ø¨Ø¹Ø¯ÛŒ</h3>
                    <div class="reward-amount" id="nextReward">Û°.Û°Û± USDT</div>
                </div>
            </div>

            <div class="progress-container">
                <div class="progress-header">
                    <div class="progress-label">Ù¾ÛŒØ´Ø±ÙØª ÙØ¹Ù„ÛŒ</div>
                    <div class="progress-value" id="progressText">Û° / Û±Û°,Û°Û°Û°,Û°Û°Û° SOD (Û°.Û°Û± USDT)</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
            </div>

            <div class="stats-view">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-title">Ø¢Ø®Ø±ÛŒÙ† Ø¯Ø±ÛŒØ§ÙØª</div>
                            <div class="stat-value" id="lastClaimTime">Ù‡Ù†ÙˆØ² Ø¯Ø±ÛŒØ§ÙØª Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯</div>
                        </div>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-title">Ø³Ø·Ø­ Ø´Ù…Ø§</div>
                            <div class="stat-value" id="userLevel">Û±</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Ø¬Ø¯ÙˆÙ„ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ -->
        <section class="transactions-section">
            <div class="section-header">
                <h2 class="section-title">ğŸ“‹ ØªØ§Ø±ÛŒØ®Ú†Ù‡ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§</h2>
                <p class="section-subtitle">Ù†Ù…Ø§ÛŒØ´ ØªÙ…Ø§Ù…ÛŒ ÙØ¹Ø§Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§Ø³ØªØ®Ø±Ø§Ø¬ØŒ Ø®Ø±ÛŒØ¯ Ùˆ ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§</p>
            </div>

            <div class="transactions-table">
                <div id="transactionsList">
                    <!-- ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ Ø¨Ø§ JS Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                </div>
            </div>
        </section>
    </div>

    <!-- Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† -->
    <div class="notification" id="notification">
        <div class="notification-icon">
            <i class="fas fa-check"></i>
        </div>
        <div class="notification-content">
            <h4 id="notificationTitle">Ø¹Ù…Ù„ÛŒØ§Øª Ù…ÙˆÙÙ‚</h4>
            <p id="notificationMessage">Ù¾ÛŒØ§Ù… Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯</p>
        </div>
    </div>

    <!-- JavaScript -->
    <script type="module">
        // =============================================
        // SODmAX Pro - Ù†Ø³Ø®Ù‡ Ú©Ø§Ù…Ù„ Ø¨Ø§ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
        // =============================================
        
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm'
        
        // Ø§Ø·Ù„Ø§Ø¹Ø§Øª Supabase
        const supabaseUrl = 'https://ttcwbmflesuoyniwoszl.supabase.co'
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR0Y3dibWZsZXN1b3luaXdvc3psIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4NTQÛ³Û¸Û²ØŒ"Ø¨Ø¨Ø®Ø´ÛŒØ¯ Ú©Ù„ÛŒØ¯ØªÙˆÙ† Ø±Ùˆ Ø¯Ø§Ø±Ù… Ù…ÛŒØ¨ÛŒÙ†Ù… Ù…Ø´Ú©Ù„ Ø¯Ø§Ø±Ù‡ØŒ Ø¨Ø²Ø§Ø±ÛŒØ¯ ÛŒÙ‡ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†Ù…"}';
        
        const supabase = createClient(supabaseUrl, supabaseAnonKey)
        
        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²ÛŒ
        let gameData = {
            sodBalance: 0,
            usdtBalance: 0,
            todayEarnings: 0,
            miningPower: 10,
            userLevel: 1,
            usdtProgress: 0,
            autoMining: false,
            boostActive: false,
            totalMined: 0
        };
        
        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
        let userData = {
            isRegistered: false,
            fullName: "",
            email: "",
            userId: null,
            referralCode: ""
        };
        
        // Ù¾Ù†Ù„â€ŒÙ‡Ø§ÛŒ ÙØ±ÙˆØ´ SOD
        const sodSalePlans = [
            {
                id: 1,
                name: "Ù¾Ù†Ù„ Ø§Ø³ØªØ§Ø±ØªØ±",
                usdtPrice: 1,
                sodAmount: 5000000,
                features: ["Ûµ,Û°Û°Û°,Û°Û°Û° SOD", "Ù‡Ø¯ÛŒÙ‡ ÛµÛ°Û°,Û°Û°Û° SOD Ø§Ø¶Ø§ÙÛŒ", "Ù‚Ø¯Ø±Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬ +ÛµÙª"],
                popular: false,
                discount: 0
            },
            {
                id: 2,
                name: "Ù¾Ù†Ù„ Ù¾Ø±Ùˆ",
                usdtPrice: 5,
                sodAmount: 30000000,
                features: ["Û³Û°,Û°Û°Û°,Û°Û°Û° SOD", "Ù‡Ø¯ÛŒÙ‡ Û³,Û°Û°Û°,Û°Û°Û° SOD Ø§Ø¶Ø§ÙÛŒ", "Ù‚Ø¯Ø±Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬ +Û±ÛµÙª"],
                popular: true,
                discount: 10
            },
            {
                id: 3,
                name: "Ù¾Ù†Ù„ Ù¾Ù„Ø§ØªÛŒÙ†ÛŒÙˆÙ…",
                usdtPrice: 15,
                sodAmount: 100000000,
                features: ["Û±Û°Û°,Û°Û°Û°,Û°Û°Û° SOD", "Ù‡Ø¯ÛŒÙ‡ Û±Û°,Û°Û°Û°,Û°Û°Û° SOD Ø§Ø¶Ø§ÙÛŒ", "Ù‚Ø¯Ø±Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬ +Û³Û°Ùª"],
                popular: false,
                discount: 15
            },
            {
                id: 4,
                name: "Ù¾Ù†Ù„ Ø§Ù„Ù…Ø§Ø³",
                usdtPrice: 50,
                sodAmount: 500000000,
                features: ["ÛµÛ°Û°,Û°Û°Û°,Û°Û°Û° SOD", "Ù‡Ø¯ÛŒÙ‡ ÛµÛ°,Û°Û°Û°,Û°Û°Û° SOD Ø§Ø¶Ø§ÙÛŒ", "Ù‚Ø¯Ø±Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬ +ÛµÛ°Ùª"],
                popular: false,
                discount: 20
            }
        ];
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ ====================
        
        // Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
        function showNotification(title, message) {
            const notification = document.getElementById('notification');
            document.getElementById('notificationTitle').textContent = title;
            document.getElementById('notificationMessage').textContent = message;
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }
        
        // ÙØ±Ù…Øª Ø¹Ø¯Ø¯
        function formatNumber(num) {
            if (num >= 1000000000) return (num / 1000000000).toFixed(2) + 'B';
            if (num >= 1000000) return (num / 1000000).toFixed(1) + 'M';
            if (num >= 1000) return (num / 1000).toFixed(1) + 'K';
            return Math.floor(num).toLocaleString('fa-IR');
        }
        
        // ==================== ØªÙˆØ§Ø¨Ø¹ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ ====================
        
        // Ø¨Ø±Ø±Ø³ÛŒ Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±
        async function checkUserRegistration() {
            try {
                // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø± localStorage Ø§ÙˆÙ„
                const savedUser = localStorage.getItem('sodmaxUserData');
                if (savedUser) {
                    const data = JSON.parse(savedUser);
                    Object.assign(userData, data);
                    
                    // Ø¨Ø±Ø±Ø³ÛŒ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³
                    const { data: dbUser, error } = await supabase
                        .from('users')
                        .select('*')
                        .eq('email', userData.email)
                        .maybeSingle();
                    
                    if (dbUser && !error) {
                        userData.userId = dbUser.id;
                        userData.isRegistered = true;
                        
                        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø²ÛŒ
                        await loadUserData();
                        return true;
                    }
                }
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ø±Ø³ÛŒ Ø«Ø¨Øª Ù†Ø§Ù…:', error);
            }
            return false;
        }
        
        // Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø± Ø¬Ø¯ÛŒØ¯
        async function registerUser(fullName, email, referralCode = '') {
            try {
                showNotification('â³', 'Ø¯Ø± Ø­Ø§Ù„ Ø«Ø¨Øª Ù†Ø§Ù…...');
                
                // ØªÙˆÙ„ÛŒØ¯ Ú©Ø¯ Ø¯Ø¹ÙˆØª
                const newReferralCode = 'SOD-' + Math.random().toString(36).substr(2, 6).toUpperCase();
                
                // Ø°Ø®ÛŒØ±Ù‡ Ú©Ø§Ø±Ø¨Ø± Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³
                const { data: newUser, error } = await supabase
                    .from('users')
                    .insert({
                        email: email,
                        full_name: fullName,
                        referral_code: newReferralCode,
                        invited_by: referralCode ? await getUserIdByReferralCode(referralCode) : null
                    })
                    .select()
                    .single();
                
                if (error) {
                    if (error.code === '23505') {
                        throw new Error('Ø§ÛŒÙ† Ø§ÛŒÙ…ÛŒÙ„ Ù‚Ø¨Ù„Ø§Ù‹ Ø«Ø¨Øª Ø´Ø¯Ù‡ Ø§Ø³Øª');
                    }
                    throw error;
                }
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±
                userData = {
                    isRegistered: true,
                    fullName: fullName,
                    email: email,
                    userId: newUser.id,
                    referralCode: newReferralCode
                };
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
                await supabase
                    .from('user_balances')
                    .insert({
                        user_id: newUser.id,
                        sod_balance: 1000000
                    });
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯ Ù¾Ø±ÙˆÙØ§ÛŒÙ„
                await supabase
                    .from('user_profiles')
                    .insert({
                        user_id: newUser.id,
                        user_level: 1,
                        mining_power: 10
                    });
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
                await createUserMissions(newUser.id);
                
                // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± localStorage
                localStorage.setItem('sodmaxUserData', JSON.stringify(userData));
                
                showNotification('âœ…', 'Ø«Ø¨Øª Ù†Ø§Ù… Ù…ÙˆÙÙ‚! Û±,Û°Û°Û°,Û°Û°Û° SOD Ù‡Ø¯ÛŒÙ‡ Ú¯Ø±ÙØªÛŒØ¯.');
                return true;
                
            } catch (error) {
                showNotification('âŒ', error.message);
                return false;
            }
        }
        
        // Ø¯Ø±ÛŒØ§ÙØª ID Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ Ú©Ø¯ Ø¯Ø¹ÙˆØª
        async function getUserIdByReferralCode(code) {
            try {
                const { data, error } = await supabase
                    .from('users')
                    .select('id')
                    .eq('referral_code', code)
                    .single();
                
                if (error || !data) return null;
                return data.id;
            } catch (error) {
                return null;
            }
        }
        
        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø±
        async function loadUserData() {
            try {
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
                const { data: balance, error: balanceError } = await supabase
                    .from('user_balances')
                    .select('*')
                    .eq('user_id', userData.userId)
                    .single();
                
                if (!balanceError && balance) {
                    gameData.sodBalance = Number(balance.sod_balance) || 0;
                    gameData.usdtBalance = Number(balance.usdt_balance) || 0;
                    gameData.totalMined = Number(balance.total_mined) || 0;
                    gameData.todayEarnings = Number(balance.today_mined) || 0;
                }
                
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù¾Ø±ÙˆÙØ§ÛŒÙ„
                const { data: profile, error: profileError } = await supabase
                    .from('user_profiles')
                    .select('*')
                    .eq('user_id', userData.userId)
                    .single();
                
                if (!profileError && profile) {
                    gameData.userLevel = Number(profile.user_level) || 1;
                    gameData.miningPower = Number(profile.mining_power) || 10;
                }
                
                // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù¾ÛŒØ´Ø±ÙØª USDT
                gameData.usdtProgress = gameData.totalMined % 10000000;
                
                updateUI();
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª:', error);
            }
        }
        
        // Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø§Ø²ÛŒ
        async function saveGameData() {
            try {
                if (!userData.userId) return;
                
                // Ø¢Ù¾Ø¯ÛŒØª Ù…ÙˆØ¬ÙˆØ¯ÛŒ
                await supabase
                    .from('user_balances')
                    .update({
                        sod_balance: gameData.sodBalance,
                        usdt_balance: gameData.usdtBalance,
                        total_mined: gameData.totalMined,
                        today_mined: gameData.todayEarnings,
                        last_update: new Date().toISOString()
                    })
                    .eq('user_id', userData.userId);
                
                // Ø¢Ù¾Ø¯ÛŒØª Ù¾Ø±ÙˆÙØ§ÛŒÙ„
                await supabase
                    .from('user_profiles')
                    .update({
                        user_level: gameData.userLevel,
                        mining_power: gameData.miningPower,
                        last_active: new Date().toISOString()
                    })
                    .eq('user_id', userData.userId);
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø°Ø®ÛŒØ±Ù‡ Ø§Ø·Ù„Ø§Ø¹Ø§Øª:', error);
            }
        }
        
        // Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´
        async function addTransaction(type, amount, currency, description) {
            try {
                await supabase
                    .from('transactions')
                    .insert({
                        user_id: userData.userId,
                        transaction_type: type,
                        amount: Math.abs(amount),
                        currency: currency,
                        description: description,
                        created_at: new Date().toISOString()
                    });
                
                // Ø¢Ù¾Ø¯ÛŒØª ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù…Ø­Ù„ÛŒ
                renderTransactions();
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´:', error);
            }
        }
        
        // Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ú©Ø§Ø±Ø¨Ø±
        async function createUserMissions(userId) {
            try {
                // Ø¯Ø±ÛŒØ§ÙØª Ù‡Ù…Ù‡ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„
                const { data: missions, error } = await supabase
                    .from('missions')
                    .select('*')
                    .eq('is_active', true);
                
                if (error || !missions) return;
                
                // Ø§ÛŒØ¬Ø§Ø¯ Ø±Ú©ÙˆØ±Ø¯ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ù…Ø£Ù…ÙˆØ±ÛŒØª
                const userMissions = missions.map(mission => ({
                    user_id: userId,
                    mission_id: mission.id,
                    current_progress: 0,
                    completed: false,
                    claimed: false
                }));
                
                await supabase
                    .from('user_missions')
                    .insert(userMissions);
                    
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø§ÛŒØ¬Ø§Ø¯ Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§:', error);
            }
        }
        
        // Ø¢Ù¾Ø¯ÛŒØª Ù¾ÛŒØ´Ø±ÙØª Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§
        async function updateMissionProgress(missionType, value = 1) {
            try {
                if (!userData.userId) return;
                
                // Ù¾ÛŒØ¯Ø§ Ú©Ø±Ø¯Ù† Ù…Ø£Ù…ÙˆØ±ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ·Ù‡
                const { data: missions, error } = await supabase
                    .from('user_missions')
                    .select(`
                        *,
                        mission:missions(*)
                    `)
                    .eq('user_id', userData.userId)
                    .eq('completed', false);
                
                if (error || !missions) return;
                
                for (const userMission of missions) {
                    if (userMission.mission.mission_type === missionType) {
                        // Ø¢Ù¾Ø¯ÛŒØª Ù¾ÛŒØ´Ø±ÙØª
                        const newProgress = userMission.current_progress + value;
                        const isCompleted = newProgress >= userMission.mission.target_value;
                        
                        await supabase
                            .from('user_missions')
                            .update({
                                current_progress: Math.min(newProgress, userMission.mission.target_value),
                                completed: isCompleted,
                                completed_at: isCompleted ? new Date().toISOString() : null
                            })
                            .eq('id', userMission.id);
                        
                        if (isCompleted) {
                            showNotification('ğŸ¯', `Ù…Ø£Ù…ÙˆØ±ÛŒØª "${userMission.mission.title}" ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯!`);
                        }
                    }
                }
                
            } catch (error) {
                console.error('Ø®Ø·Ø§ Ø¯Ø± Ø¢Ù¾Ø¯ÛŒØª Ù…Ø£Ù…ÙˆØ±ÛŒØª:', error);
            }
        }
        
        // ==================== Ù…Ù†Ø·Ù‚ Ø¨Ø§Ø²ÛŒ ====================
        
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¯Ø³ØªÛŒ
        async function manualMine() {
            if (!userData.isRegistered) {
                showNotification('âŒ', 'Ø§Ø¨ØªØ¯Ø§ Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ù†ÛŒØ¯');
                return;
            }
            
            let earned = gameData.miningPower;
            if (gameData.boostActive) earned *= 3;
            
            // Ø¢Ù¾Ø¯ÛŒØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
            gameData.sodBalance += earned;
            gameData.totalMined += earned;
            gameData.todayEarnings += earned;
            gameData.usdtProgress += earned;
            
            // Ø¢Ù¾Ø¯ÛŒØª UI
            updateUI();
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³
            await saveGameData();
            
            // Ø«Ø¨Øª ØªØ±Ø§Ú©Ù†Ø´
            await addTransaction('mining', earned, 'SOD', 'Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¯Ø³ØªÛŒ');
            
            // Ø¢Ù¾Ø¯ÛŒØª Ù…Ø£Ù…ÙˆØ±ÛŒØª Ú©Ù„ÛŒÚ©
            await updateMissionProgress('click');
            
            // Ø¢Ù¾Ø¯ÛŒØª Ù…Ø£Ù…ÙˆØ±ÛŒØª Ø§Ø³ØªØ®Ø±Ø§Ø¬
            await updateMissionProgress('mining', earned);
            
            // Ø§ÛŒØ¬Ø§Ø¯ Ø§ÙÚ©Øª
            createMiningEffect(earned);
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§Ø¯Ø§Ø´ USDT
            checkUSDT();
        }
        
        // Ø¨Ø±Ø±Ø³ÛŒ Ù¾Ø§Ø¯Ø§Ø´ USDT
        async function checkUSDT() {
            if (gameData.usdtProgress >= 10000000) {
                const usdtEarned = 0.01;
                
                gameData.usdtBalance += usdtEarned;
                gameData.usdtProgress -= 10000000;
                
                showNotification('ğŸ‰', `${usdtEarned.toFixed(4)} USDT Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯ÛŒØ¯!`);
                
                await saveGameData();
                await addTransaction('reward', usdtEarned, 'USDT', 'Ù¾Ø§Ø¯Ø§Ø´ Ø§Ø³ØªØ®Ø±Ø§Ø¬');
                
                // Ø´Ø§Ù†Ø³ Ø§Ø±ØªÙ‚Ø§Ø¡ Ø³Ø·Ø­
                if (Math.random() > 0.85) {
                    gameData.userLevel++;
                    gameData.miningPower = 10 * gameData.userLevel;
                    showNotification('â­', `Ø³Ø·Ø­ Ø´Ù…Ø§ Ø¨Ù‡ ${gameData.userLevel} Ø§Ø±ØªÙ‚Ø§Ø¡ ÛŒØ§ÙØª!`);
                    
                    // Ø¢Ù¾Ø¯ÛŒØª Ù…Ø£Ù…ÙˆØ±ÛŒØª Ø³Ø·Ø­
                    await updateMissionProgress('level', 1);
                }
            }
        }
        
        // Ø®Ø±ÛŒØ¯ Ù¾Ù†Ù„ SOD
        async function buySODPlan(planId) {
            if (!userData.isRegistered) {
                showNotification('âŒ', 'Ø§Ø¨ØªØ¯Ø§ Ø«Ø¨Øª Ù†Ø§Ù… Ú©Ù†ÛŒØ¯');
                return;
            }
            
            const plan = sodSalePlans.find(p => p.id === planId);
            if (!plan) return;
            
            // Ø¯Ø± Ù†Ø³Ø®Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ Ø§ÛŒÙ†Ø¬Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯
            const bonusSOD = Math.floor(plan.sodAmount * (plan.discount / 100));
            const totalSOD = plan.sodAmount + bonusSOD;
            
            gameData.sodBalance += totalSOD;
            
            showNotification('ğŸ‰', `Ù¾Ù†Ù„ ${plan.name} Ø®Ø±ÛŒØ¯Ø§Ø±ÛŒ Ø´Ø¯! ${formatNumber(totalSOD)} SOD Ø¯Ø±ÛŒØ§ÙØª Ú©Ø±Ø¯ÛŒØ¯.`);
            
            await saveGameData();
            await addTransaction('purchase', totalSOD, 'SOD', `Ø®Ø±ÛŒØ¯ Ù¾Ù†Ù„ ${plan.name}`);
            
            updateUI();
        }
        
        // Ø¯Ø±ÛŒØ§ÙØª USDT
        async function claimUSDT() {
            if (gameData.usdtBalance > 0) {
                const usdtToClaim = gameData.usdtBalance;
                const sodNeeded = usdtToClaim * 1000000000;
                
                if (gameData.sodBalance >= sodNeeded) {
                    if (confirm(`Ø¢ÛŒØ§ Ù…Ø§ÛŒÙ„ Ø¨Ù‡ Ø¯Ø±ÛŒØ§ÙØª ${usdtToClaim.toFixed(4)} USDT Ù‡Ø³ØªÛŒØ¯ØŸ\n${formatNumber(sodNeeded)} SOD Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø³Ø± Ø®ÙˆØ§Ù‡Ø¯ Ø´Ø¯.`)) {
                        gameData.usdtBalance = 0;
                        gameData.sodBalance -= sodNeeded;
                        
                        showNotification('âœ…', `${usdtToClaim.toFixed(4)} USDT Ø¯Ø±ÛŒØ§ÙØª Ø´Ø¯.`);
                        
                        await saveGameData();
                        await addTransaction('withdrawal', -usdtToClaim, 'USDT', 'Ø¯Ø±ÛŒØ§ÙØª Ù¾Ø§Ø¯Ø§Ø´ USDT');
                        await addTransaction('conversion', -sodNeeded, 'SOD', 'ØªØ¨Ø¯ÛŒÙ„ SOD Ø¨Ù‡ USDT');
                        
                        updateUI();
                    }
                } else {
                    showNotification('âš ï¸', `Ù…ÙˆØ¬ÙˆØ¯ÛŒ SOD Ú©Ø§ÙÛŒ Ù†ÛŒØ³Øª. Ù†ÛŒØ§Ø²: ${formatNumber(sodNeeded)} SOD`);
                }
            } else {
                showNotification('ğŸ’°', 'Ù‡Ù†ÙˆØ² USDT Ù¾Ø§Ø¯Ø§Ø´ Ø¯Ø±ÛŒØ§ÙØª Ù†Ú©Ø±Ø¯Ù‡â€ŒØ§ÛŒØ¯.');
            }
        }
        
        // Ø§ÙØ²Ø§ÛŒØ´ Ù‚Ø¯Ø±Øª
        async function boostMining() {
            if (gameData.sodBalance >= 5000) {
                gameData.sodBalance -= 5000;
                gameData.boostActive = true;
                gameData.miningPower *= 3;
                
                showNotification('âš¡', 'Ù‚Ø¯Ø±Øª Ø§Ø³ØªØ®Ø±Ø§Ø¬ Û³ Ø¨Ø±Ø§Ø¨Ø± Ø´Ø¯! (Û³Û° Ø¯Ù‚ÛŒÙ‚Ù‡)');
                
                await saveGameData();
                await addTransaction('boost', -5000, 'SOD', 'Ø®Ø±ÛŒØ¯ Ø§ÙØ²Ø§ÛŒØ´ Ù‚Ø¯Ø±Øª');
                
                updateUI();
                
                setTimeout(() => {
                    gameData.boostActive = false;
                    gameData.miningPower = 10 * gameData.userLevel;
                    showNotification('â°', 'Ø²Ù…Ø§Ù† Ø§ÙØ²Ø§ÛŒØ´ Ù‚Ø¯Ø±Øª Ø¨Ù‡ Ù¾Ø§ÛŒØ§Ù† Ø±Ø³ÛŒØ¯.');
                    updateUI();
                }, 30 * 60 * 1000);
            } else {
                showNotification('âš ï¸', 'Ø¨Ø±Ø§ÛŒ Ø§ÙØ²Ø§ÛŒØ´ Ù‚Ø¯Ø±Øª Ø¨Ù‡ ÛµÛ°Û°Û° SOD Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯.');
            }
        }
        
        // ==================== UI Functions ====================
        
        function updateUI() {
            // Ù…ÙˆØ¬ÙˆØ¯ÛŒâ€ŒÙ‡Ø§
            document.getElementById('sodBalance').innerHTML = formatNumber(gameData.sodBalance) + ' <span>SOD</span>';
            document.getElementById('usdtBalance').innerHTML = gameData.usdtBalance.toFixed(4) + ' <span>USDT</span>';
            
            // Ø¢Ù…Ø§Ø±
            document.getElementById('todayEarnings').textContent = formatNumber(gameData.todayEarnings) + ' SOD';
            document.getElementById('miningPower').textContent = gameData.miningPower + 'x';
            document.getElementById('clickReward').textContent = '+' + gameData.miningPower + ' SOD';
            document.getElementById('userLevel').textContent = gameData.userLevel;
            
            // Ù¾Ø§Ø¯Ø§Ø´ USDT
            document.getElementById('availableUSDT').textContent = gameData.usdtBalance.toFixed(4) + ' USDT';
            document.getElementById('nextReward').textContent = 'Û°.Û°Û± USDT';
            
            const progressPercent = (gameData.usdtProgress / 10000000) * 100;
            document.getElementById('progressFill').style.width = progressPercent + '%';
            document.getElementById('progressText').textContent = formatNumber(gameData.usdtProgress) + ' / Û±Û°,Û°Û°Û°,Û°Û°Û° SOD (Û°.Û°Û± USDT)';
        }
        
        function renderTransactions() {
            const list = document.getElementById('transactionsList');
            if (!list) return;
            
            // Ù†Ù…Ø§ÛŒØ´ Ù†Ù…ÙˆÙ†Ù‡â€ŒØ§ÛŒ Ø§Ø² ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§
            list.innerHTML = `
                <div class="transaction-row">
                    <div class="transaction-type">
                        <div class="transaction-icon">â›ï¸</div>
                        <div style="flex: 1;">
                            <div style="font-weight: bold;">Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø¯Ø³ØªÛŒ</div>
                            <div style="color: var(--text-secondary); font-size: 12px;">Ù‡Ù…ÛŒÙ† Ø§Ù„Ø§Ù†</div>
                        </div>
                        <div style="font-weight: bold; color: var(--primary-light);">+${gameData.miningPower} SOD</div>
                    </div>
                </div>
            `;
        }
        
        function createMiningEffect(amount) {
            const effect = document.createElement('div');
            effect.style.cssText = `
                position: fixed;
                color: var(--primary-light);
                font-weight: 900;
                font-size: 16px;
                pointer-events: none;
                z-index: 10000;
                text-shadow: 0 0 10px var(--primary);
                animation: miningEffect 1s ease-out forwards;
            `;
            
            const core = document.getElementById('minerCore');
            const rect = core.getBoundingClientRect();
            effect.style.left = rect.left + rect.width / 2 + 'px';
            effect.style.top = rect.top + rect.height / 2 + 'px';
            effect.textContent = '+' + formatNumber(amount);
            
            document.body.appendChild(effect);
            
            setTimeout(() => effect.remove(), 1000);
        }
        
        // ==================== Event Handlers ====================
        
        async function handleRegistration(e) {
            e.preventDefault();
            
            const fullName = document.getElementById('fullName').value.trim();
            const email = document.getElementById('email').value.trim();
            const referralCode = document.getElementById('referralCode').value.trim();
            
            if (!fullName || !email) {
                showNotification('âŒ', 'Ù„Ø·ÙØ§Ù‹ Ù†Ø§Ù… Ùˆ Ø§ÛŒÙ…ÛŒÙ„ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            const success = await registerUser(fullName, email, referralCode);
            if (success) {
                hideRegister();
                startGame();
            }
        }
        
        function showSODSale() {
            document.getElementById('sodSaleSection').style.display = 'block';
            document.getElementById('sodSaleSection').scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }
        
        // ==================== Initialization ====================
        
        function hideRegister() {
            document.getElementById('registerOverlay').style.display = 'none';
            document.getElementById('mainContainer').style.display = 'block';
        }
        
        function showRegister() {
            document.getElementById('registerOverlay').style.display = 'flex';
            document.getElementById('mainContainer').style.display = 'none';
        }
        
        async function startGame() {
            updateUI();
            renderSODSalePlans();
            
            showNotification('ğŸŒŸ', `Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯ ${userData.fullName}!`);
            
            // Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø¯Ù…ÛŒÙ†
            checkAdminAccess();
        }
        
        function renderSODSalePlans() {
            const grid = document.getElementById('salePlansGrid');
            if (!grid) return;
            
            grid.innerHTML = '';
            
            sodSalePlans.forEach(plan => {
                const card = document.createElement('div');
                card.className = `sale-plan-card ${plan.popular ? 'featured' : ''}`;
                
                const totalSOD = plan.sodAmount + Math.floor(plan.sodAmount * (plan.discount / 100));
                
                card.innerHTML = `
                    ${plan.popular ? `<div class="sale-plan-badge">Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ ÙˆÛŒÚ˜Ù‡</div>` : ''}
                    ${plan.discount > 0 ? `<div style="position: absolute; top: 16px; right: 16px;"><span class="discount-badge">${plan.discount}% ØªØ®ÙÛŒÙ</span></div>` : ''}
                    
                    <div class="sale-plan-header">
                        <h3 class="sale-plan-name">${plan.name}</h3>
                        <div class="sale-plan-price">${plan.usdtPrice} <span>USDT</span></div>
                        <div class="sod-amount">${formatNumber(totalSOD)} SOD</div>
                    </div>
                    
                    <ul class="sale-plan-features">
                        ${plan.features.map(feature => `<li><i class="fas fa-check" style="color: var(--success);"></i> ${feature}</li>`).join('')}
                    </ul>
                    
                    <button class="btn ${plan.popular ? 'btn-warning' : 'btn-primary'}" onclick="buySODPlan(${plan.id})">
                        <i class="fas fa-shopping-cart"></i>
                        Ø®Ø±ÛŒØ¯ Ù¾Ù†Ù„
                    </button>
                `;
                
                grid.appendChild(card);
            });
        }
        
        function checkAdminAccess() {
            if (userData.email === "hamyarhf@gmail.com") {
                document.getElementById('adminLink').style.display = 'flex';
            }
        }
        
        // ==================== Event Listeners ====================
        
        document.getElementById('registerForm').addEventListener('submit', handleRegistration);
        document.getElementById('minerCore').addEventListener('click', manualMine);
        document.getElementById('claimUSDTBtn').addEventListener('click', claimUSDT);
        
        document.getElementById('autoMineBtn').addEventListener('click', function() {
            if (gameData.sodBalance < 1000000) {
                showNotification('âš ï¸', 'Ø¨Ø±Ø§ÛŒ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø± Ø­Ø¯Ø§Ù‚Ù„ Û± Ù…ÛŒÙ„ÛŒÙˆÙ† SOD Ù†ÛŒØ§Ø² Ø¯Ø§Ø±ÛŒØ¯.');
                return;
            }
            
            gameData.autoMining = !gameData.autoMining;
            
            if (gameData.autoMining) {
                this.innerHTML = '<i class="fas fa-pause"></i> ØªÙˆÙ‚Ù Ø®ÙˆØ¯Ú©Ø§Ø±';
                this.style.background = 'var(--error)';
                showNotification('ğŸ¤–', 'Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ¹Ø§Ù„ Ø´Ø¯.');
                
                // Ø´Ø±ÙˆØ¹ Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø±
                const interval = setInterval(() => {
                    if (!gameData.autoMining) {
                        clearInterval(interval);
                        return;
                    }
                    manualMine();
                }, 1000);
            } else {
                this.innerHTML = '<i class="fas fa-robot"></i> Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø±';
                this.style.background = '';
                showNotification('â¸ï¸', 'Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø®ÙˆØ¯Ú©Ø§Ø± Ù…ØªÙˆÙ‚Ù Ø´Ø¯.');
            }
        });
        
        // ==================== Initialize ====================
        
        async function init() {
            const isRegistered = await checkUserRegistration();
            
            if (isRegistered) {
                startGame();
            } else {
                showRegister();
            }
            
            // Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø± Ù‡Ø± 30 Ø«Ø§Ù†ÛŒÙ‡
            setInterval(async () => {
                if (userData.isRegistered) {
                    await saveGameData();
                }
            }, 30000);
        }
        
        // Ø´Ø±ÙˆØ¹ Ø¨Ø±Ù†Ø§Ù…Ù‡
        window.addEventListener('DOMContentLoaded', init);
        
        console.log('ğŸš€ SODmAX Pro Ø¨Ø§ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª!');
    </script>
</body>
</html>
