<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <!-- ... همه کدهای قبلی index.txt ... -->
    <!-- (همه کدهای قبلی بدون تغییر باقی می‌مونه) -->
</head>
<body>
    <!-- ... همه کدهای قبلی index.txt ... -->
    
    <!-- فقط این قسمت از nav-menu رو تغییر بده (حدود خط 80): -->
    <div class="nav-menu">
        <a href="dashboard.html">
            <i class="fas fa-chart-line"></i>
            <span class="nav-text">داشبورد</span>
        </a>
        <a href="leaderboard.html">
            <i class="fas fa-trophy"></i>
            <span class="nav-text">لیدربرد</span>
        </a>
        <a href="missions.html">
            <i class="fas fa-tasks"></i>
            <span class="nav-text">مأموریت‌ها</span>
        </a>
        <!-- این لینک جدید رو اضافه کن: -->
        <a href="admin.html" id="adminLink" style="display: none; background: rgba(148,163,184,0.3);">
            <i class="fas fa-user-shield"></i>
            <span class="nav-text">مدیریت</span>
        </a>
    </div>

    <!-- ... بقیه کدهای index.txt ... -->

    <script>
        // ... همه کدهای قبلی script ... 
        
        // ========== تابع جدید برای تشخیص ادمین ==========
        function checkAdminAccess() {
            try {
                const userData = JSON.parse(localStorage.getItem('sodmaxUserData') || '{}');
                const adminEmails = ["hamyarhf@gmail.com"];
                
                if (adminEmails.includes(userData.email)) {
                    document.getElementById('adminLink').style.display = 'flex';
                }
            } catch (e) {
                console.log('خطا در تشخیص ادمین:', e);
            }
        }
        
        // ========== در init() اضافه کن: ==========
        function init() {
            // ... کدهای قبلی init ...
            
            // بعد از همه کدهای init، این خط رو اضافه کن:
            setTimeout(checkAdminAccess, 1000);
        }
        
        // ========== سیستم ذخیره‌سازی پیشرفته (اختیاری) ==========
        function saveGameAdvanced() {
            try {
                if (!userData.email) return;
                
                // ذخیره کاربر
                localStorage.setItem('sodmaxUser_' + userData.email, JSON.stringify(userData));
                
                // ذخیره اطلاعات بازی
                localStorage.setItem('sodmaxGame_' + userData.email, JSON.stringify(gameData));
                
                // آپدیت کاربران فعال
                updateActiveUsers();
                
            } catch (e) {
                console.log('خطا در ذخیره:', e);
            }
        }

        function updateActiveUsers() {
            try {
                let activeUsers = JSON.parse(localStorage.getItem('sodmaxActiveUsers') || '[]');
                
                const userIndex = activeUsers.findIndex(u => u.email === userData.email);
                const userInfo = {
                    email: userData.email,
                    name: userData.fullName,
                    level: gameData.userLevel || 1,
                    sod: gameData.sodBalance || 0,
                    usdt: gameData.usdtBalance || 0,
                    lastActive: new Date().toISOString()
                };
                
                if (userIndex === -1) {
                    activeUsers.push(userInfo);
                } else {
                    activeUsers[userIndex] = userInfo;
                }
                
                localStorage.setItem('sodmaxActiveUsers', JSON.stringify(activeUsers));
                
            } catch (e) {
                console.log('خطا در آپدیت کاربران فعال:', e);
            }
        }
        
        // ========== تغییر saveGame به saveGameAdvanced ==========
        // خط 472 در index.txt رو پیدا کن (تابع saveGame)
        // و با این جایگزین کن:
        function saveGame() {
            saveGameAdvanced();
        }
        
        // ... بقیه کدهای script ...
    </script>
</body>
</html>
